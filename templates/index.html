<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClearCredit XAI | AI Risk Assessment</title>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Outfit:wght@500;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

    <!-- Dynamic Background -->
    <div class="bg-orb bg-orb-1"></div>
    <div class="bg-orb bg-orb-2"></div>

    <!-- Loading Overlay -->
    <div id="loaderOverlay">
        <div class="spinner"></div>
        <div class="loading-text">Analyzing Risk Profile...</div>
    </div>

    <header class="app-container fade-in-up">
        <div class="brand">
            <i class="fas fa-shield-alt fa-lg"></i>
            <div>Clear<span>Credit</span> XAI</div>
        </div>
        <!-- Optional: Status Indicator -->
        <div style="display: flex; gap: 1rem; align-items: center;">
            <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.9rem; color: var(--text-muted);">
                <span
                    style="width: 8px; height: 8px; background: var(--secondary-color); border-radius: 50%; box-shadow: 0 0 10px var(--secondary-color);"></span>
                System Online
            </div>
        </div>
    </header>

    <div class="app-container fade-in-up delay-1">
        <div class="glass-card">
            <h1 class="text-center mb-4">New Application Analysis</h1>

            <!-- Wizard Indicators -->
            <div class="wizard-steps">
                <div class="progress-track">
                    <div class="progress-fill"></div>
                </div>

                <div class="step-item active">
                    <div class="step-circle">1</div>
                    <div class="step-label">Profile</div>
                </div>
                <div class="step-item">
                    <div class="step-circle">2</div>
                    <div class="step-label">Loan</div>
                </div>
                <div class="step-item">
                    <div class="step-circle">3</div>
                    <div class="step-label">History</div>
                </div>
            </div>

            <form action="/predict" method="post" id="riskForm">

                <!-- Step 1: Personal Profile -->
                <div class="form-step active">
                    <h3 style="margin-bottom: 2rem; font-weight: 600;">Tell us about yourself</h3>
                    <div class="form-grid">
                        <!-- Age -->
                        <div class="input-wrapper">
                            <div class="input-group">
                                <input type="number" name="person_age" id="age" placeholder=" " required min="18"
                                    max="100">
                                <label for="age">Applicant Age</label>
                                <i class="fas fa-birthday-cake input-icon"></i>
                            </div>
                        </div>

                        <!-- Employment Length -->
                        <div class="input-wrapper">
                            <div class="input-group">
                                <input type="number" step="0.1" name="person_emp_length" id="emp" placeholder=" "
                                    required min="0">
                                <label for="emp">Employment Length (Years)</label>
                                <i class="fas fa-briefcase input-icon"></i>
                            </div>
                        </div>

                        <!-- Income -->
                        <div class="input-wrapper">
                            <div class="input-group">
                                <input type="text" name="person_income" id="income" class="number-format"
                                    placeholder=" " required style="padding-left: 2.5rem;">
                                <label for="income" style="left: 2.5rem;">Annual Income</label>
                                <span class="input-prefix">$</span>
                            </div>
                        </div>
                    </div>

                    <!-- Home Ownership (Card Grid) -->
                    <div style="margin-top: 2rem;">
                        <label
                            style="position: relative; top: 0; left: 0; margin-bottom: 1rem; color: var(--text-main);">Home
                            Ownership Status</label>
                        <input type="hidden" name="person_home_ownership" id="home_ownership" required>
                        <div class="selection-grid" id="home_ownership_grid">
                            <div class="selection-card" data-value="RENT" onclick="selectCard(this, 'home_ownership')">
                                <i class="fas fa-building"></i>
                                <span>Rent</span>
                            </div>
                            <div class="selection-card" data-value="OWN" onclick="selectCard(this, 'home_ownership')">
                                <i class="fas fa-home"></i>
                                <span>Own</span>
                            </div>
                            <div class="selection-card" data-value="MORTGAGE"
                                onclick="selectCard(this, 'home_ownership')">
                                <i class="fas fa-file-contract"></i>
                                <span>Mortgage</span>
                            </div>
                            <div class="selection-card" data-value="OTHER" onclick="selectCard(this, 'home_ownership')">
                                <i class="fas fa-question-circle"></i>
                                <span>Other</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Loan Details -->
                <div class="form-step">
                    <h3 style="margin-bottom: 2rem; font-weight: 600;">Loan Information</h3>

                    <!-- Loan Intent (Card Grid) -->
                    <div style="margin-bottom: 2rem;">
                        <label
                            style="position: relative; top: 0; left: 0; margin-bottom: 1rem; color: var(--text-main);">Loan
                            Purpose</label>
                        <input type="hidden" name="loan_intent" id="loan_intent" required>
                        <div class="selection-grid">
                            <div class="selection-card" data-value="PERSONAL" onclick="selectCard(this, 'loan_intent')">
                                <i class="fas fa-user"></i>
                                <span>Personal</span>
                            </div>
                            <div class="selection-card" data-value="EDUCATION"
                                onclick="selectCard(this, 'loan_intent')">
                                <i class="fas fa-graduation-cap"></i>
                                <span>Education</span>
                            </div>
                            <div class="selection-card" data-value="MEDICAL" onclick="selectCard(this, 'loan_intent')">
                                <i class="fas fa-notes-medical"></i>
                                <span>Medical</span>
                            </div>
                            <div class="selection-card" data-value="VENTURE" onclick="selectCard(this, 'loan_intent')">
                                <i class="fas fa-rocket"></i>
                                <span>Venture</span>
                            </div>
                            <div class="selection-card" data-value="HOMEIMPROVEMENT"
                                onclick="selectCard(this, 'loan_intent')">
                                <i class="fas fa-paint-roller"></i>
                                <span>Home Imp.</span>
                            </div>
                            <div class="selection-card" data-value="DEBTCONSOLIDATION"
                                onclick="selectCard(this, 'loan_intent')">
                                <i class="fas fa-wallet"></i>
                                <span>Debt</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-grid">
                        <!-- Loan Amount -->
                        <div class="input-wrapper">
                            <div class="input-group">
                                <input type="text" name="loan_amnt" id="amnt" class="number-format" placeholder=" "
                                    required style="padding-left: 2.5rem;">
                                <label for="amnt" style="left: 2.5rem;">Loan Amount</label>
                                <span class="input-prefix">$</span>
                            </div>
                        </div>

                        <!-- Interest Rate -->
                        <div class="input-wrapper">
                            <div class="input-group">
                                <input type="number" step="0.01" name="loan_int_rate" id="rate" placeholder=" " required
                                    min="1" max="100">
                                <label for="rate">Interest Rate (%)</label>
                                <i class="fas fa-percent input-icon"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Loan Grade (Mini Grid) -->
                    <div style="margin-top: 1.5rem;">
                        <label
                            style="position: relative; top: 0; left: 0; margin-bottom: 1rem; color: var(--text-main);">Projected
                            Loan Grade</label>
                        <input type="hidden" name="loan_grade" id="loan_grade" required>
                        <div class="selection-grid" style="grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));">
                            <div class="selection-card" data-value="A" onclick="selectCard(this, 'loan_grade')">
                                <span>A</span>
                            </div>
                            <div class="selection-card" data-value="B" onclick="selectCard(this, 'loan_grade')">
                                <span>B</span>
                            </div>
                            <div class="selection-card" data-value="C" onclick="selectCard(this, 'loan_grade')">
                                <span>C</span>
                            </div>
                            <div class="selection-card" data-value="D" onclick="selectCard(this, 'loan_grade')">
                                <span>D</span>
                            </div>
                            <div class="selection-card" data-value="E" onclick="selectCard(this, 'loan_grade')">
                                <span>E</span>
                            </div>
                            <div class="selection-card" data-value="F" onclick="selectCard(this, 'loan_grade')">
                                <span>F</span>
                            </div>
                            <div class="selection-card" data-value="G" onclick="selectCard(this, 'loan_grade')">
                                <span>G</span>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Step 3: Financial History -->
                <div class="form-step">
                    <h3 style="margin-bottom: 2rem; font-weight: 600;">Financial Background</h3>

                    <div class="form-grid">
                        <!-- LTI Ratio -->
                        <div class="input-wrapper">
                            <div class="input-group">
                                <input type="number" step="0.01" max="1" min="0" name="loan_percent_income" id="lti"
                                    placeholder=" " required>
                                <label for="lti">Loan-to-Income Ratio (0.0 - 1.0)</label>
                                <i class="fas fa-balance-scale input-icon"></i>
                            </div>
                        </div>

                        <!-- Credit Hist Length -->
                        <div class="input-wrapper">
                            <div class="input-group">
                                <input type="number" name="cb_person_cred_hist_length" id="hist" placeholder=" "
                                    required min="0">
                                <label for="hist">Credit History (Years)</label>
                                <i class="fas fa-history input-icon"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Default History (Switch style) -->
                    <div style="margin-top: 2rem;">
                        <label
                            style="position: relative; top: 0; left: 0; margin-bottom: 1rem; color: var(--text-main);">Have
                            you defaulted before?</label>
                        <input type="hidden" name="cb_person_default_on_file" id="default_hist" required>
                        <div class="selection-grid" style="max-width: 400px; margin: 1rem auto;">
                            <div class="selection-card" data-value="N" onclick="selectCard(this, 'default_hist')">
                                <i class="fas fa-check-circle" style="color: var(--secondary-color);"></i>
                                <span>No, Never</span>
                            </div>
                            <div class="selection-card" data-value="Y" onclick="selectCard(this, 'default_hist')">
                                <i class="fas fa-exclamation-circle" style="color: var(--primary-color);"></i>
                                <span>Yes, I have</span>
                            </div>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="text-center" style="margin-top: 3rem; display: none;">
                        <button type="submit" class="btn-primary" id="submitBtn">
                            Assess Risk Profile <i class="fas fa-shield-alt"></i>
                        </button>
                        <p style="margin-top: 1rem; font-size: 0.8rem; color: var(--text-muted);">
                            <i class="fas fa-lock"></i> Encryption End-to-End
                        </p>
                    </div>
                </div>

                <!-- Wizard Navigation -->
                <div class="wizard-nav">
                    <button type="button" class="btn-primary" id="prevBtn"
                        style="background: transparent; border: 1px solid rgba(255,255,255,0.2);">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button type="button" class="btn-primary" id="nextBtn">
                        Next Step <i class="fas fa-arrow-right"></i>
                    </button>
                </div>

            </form>
        </div>
    </div>

    <!-- Script -->
    <script src="{{ url_for('static', filename='script.js') }}"></script>
    <script>
        // Inline script for specific page checks if needed, but mostly in script.js
        document.getElementById('riskForm').addEventListener('submit', function () {
            document.getElementById('loaderOverlay').style.display = 'flex';
        });
    </script>
</body>

</html>